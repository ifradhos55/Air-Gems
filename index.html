<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Gesture Gems</title>

    <style>
        :root{
            --bg0:#050508;
            --bg1:#090911;
            --panel: rgba(255,255,255,.04);
            --panel2: rgba(255,255,255,.03);
            --stroke: rgba(255,255,255,.10);
            --stroke2: rgba(255,255,255,.14);
            --text:#ececf2;
            --muted: rgba(236,236,242,.70);

            --blood:#b00020;
            --blood2:#ff1f3d;

            --ruby:#ff2a4d;
            --emerald:#20d97b;
            --sapphire:#2a6dff;
            --amethyst:#a855f7;
            --amber:#f59e0b;
            --ice:#6ee7ff;
            --slate:#9ca3af;
        }

        *{box-sizing:border-box}
        html,body{height:100%}
        body{
            margin:0;
            color:var(--text);
            font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
            background:
                    radial-gradient(900px 700px at 20% 15%, rgba(176,0,32,.20) 0%, rgba(176,0,32,0) 60%),
                    radial-gradient(900px 700px at 90% 15%, rgba(42,109,255,.10) 0%, rgba(42,109,255,0) 60%),
                    radial-gradient(1200px 800px at 50% 110%, rgba(168,85,247,.12) 0%, rgba(168,85,247,0) 60%),
                    linear-gradient(180deg, var(--bg1), var(--bg0));
            display:flex;
            align-items:center;
            justify-content:center;
            padding:18px;
        }

        .app{
            width:min(1180px, 100%);
            display:grid;
            grid-template-columns: 460px 1fr;
            gap:16px;
        }
        @media (max-width: 1000px){
            .app{ grid-template-columns: 1fr; }
        }

        .card{
            background: linear-gradient(180deg, var(--panel), var(--panel2));
            border: 1px solid var(--stroke);
            border-radius: 22px;
            box-shadow: 0 18px 60px rgba(0,0,0,.45);
            overflow:hidden;
            position:relative;
        }
        .card::before{
            content:"";
            position:absolute;
            inset:-2px;
            background:
                    radial-gradient(800px 250px at 10% 0%, rgba(255,255,255,.06), rgba(255,255,255,0) 65%),
                    radial-gradient(700px 260px at 90% 0%, rgba(176,0,32,.18), rgba(176,0,32,0) 70%);
            pointer-events:none;
            opacity:.85;
        }

        .cardInner{ position:relative; padding:16px; }

        .top{
            display:flex;
            align-items:flex-start;
            justify-content:space-between;
            gap:12px;
            margin-bottom:10px;
        }
        .brand{
            display:flex;
            flex-direction:column;
            gap:6px;
        }
        .brand h1{
            margin:0;
            font-size: 16px;
            letter-spacing: .2px;
            font-weight: 800;
        }
        .sub{
            font-size: 12px;
            color: var(--muted);
            line-height: 1.35;
        }

        .pill{
            display:inline-flex;
            align-items:center;
            gap:8px;
            padding: 8px 10px;
            border-radius: 999px;
            border:1px solid var(--stroke);
            background: rgba(176,0,32,.15);
            color: rgba(255,255,255,.92);
            font-size: 12px;
            font-weight: 700;
            letter-spacing:.2px;
            white-space:nowrap;
        }
        .led{
            width:8px;height:8px;border-radius:999px;
            background: rgba(156,163,175,.95);
            box-shadow: 0 0 0 6px rgba(156,163,175,.12);
        }
        .led.on{
            background: rgba(32,217,123,.95);
            box-shadow: 0 0 0 6px rgba(32,217,123,.16);
        }

        .controls{
            display:flex;
            gap:10px;
            flex-wrap:wrap;
            margin: 12px 0 12px;
        }
        button{
            appearance:none;
            border: 1px solid var(--stroke);
            background: rgba(255,255,255,.04);
            color: var(--text);
            padding: 10px 12px;
            border-radius: 14px;
            cursor:pointer;
            font-weight: 800;
            font-size: 13px;
            letter-spacing: .15px;
            transition: transform .12s ease, background .12s ease, border-color .12s ease;
            user-select:none;
        }
        button.primary{
            background: rgba(176,0,32,.22);
            border-color: rgba(176,0,32,.35);
        }
        button:hover{ transform: translateY(-1px); border-color: var(--stroke2); }
        button:active{ transform: translateY(0px) scale(.99); }
        button:disabled{
            opacity:.55;
            cursor:not-allowed;
            transform:none;
        }

        .stats{
            display:flex;
            gap:12px;
            flex-wrap:wrap;
            margin-top:8px;
            color: var(--muted);
            font-size: 12px;
            align-items:center;
        }
        .kpi{
            display:flex;
            align-items:center;
            gap:8px;
            padding: 8px 10px;
            border-radius: 14px;
            border:1px solid var(--stroke);
            background: rgba(0,0,0,.18);
        }
        .mono{ font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace; }

        .videoWrap{
            margin-top:12px;
            border-radius: 18px;
            overflow:hidden;
            border: 1px solid var(--stroke);
            background:#000;
            aspect-ratio: 16/9;
            position:relative;
        }
        video, canvas{
            position:absolute;
            inset:0;
            width:100%;
            height:100%;
            object-fit: cover;
            transform: scaleX(-1);
        }

        .pointer{
            position: fixed;
            left:0; top:0;
            width: 18px; height: 18px;
            margin-left:-9px; margin-top:-9px;
            border-radius: 999px;
            border: 2px solid rgba(255,255,255,.85);
            background: rgba(255,255,255,.05);
            box-shadow: 0 0 0 12px rgba(176,0,32,.14);
            pointer-events:none;
            z-index:9999;
            transform: translate(-9999px,-9999px);
            transition: box-shadow .06s ease, border-color .06s ease;
            backdrop-filter: blur(4px);
        }
        .pointer.pinch{
            border-color: rgba(255,255,255,.95);
            box-shadow:
                    0 0 0 16px rgba(32,217,123,.18),
                    0 0 20px rgba(32,217,123,.25);
        }

        .gridHead{
            display:flex;
            align-items:flex-start;
            justify-content:space-between;
            gap:12px;
            margin-bottom: 10px;
        }
        .gridHead h2{
            margin:0;
            font-size: 14px;
            font-weight: 900;
            letter-spacing:.2px;
        }

        .gems{
            display:grid;
            grid-template-columns: repeat(6, minmax(0, 1fr));
            gap: 12px;
        }
        @media (max-width: 1100px){ .gems{ grid-template-columns: repeat(5, 1fr);} }
        @media (max-width: 920px){ .gems{ grid-template-columns: repeat(4, 1fr);} }
        @media (max-width: 560px){ .gems{ grid-template-columns: repeat(3, 1fr);} }

        .gem{
            aspect-ratio: 1/1;
            border-radius: 18px;
            border: 1px solid var(--stroke);
            background: rgba(255,255,255,.02);
            cursor:pointer;
            user-select:none;
            position:relative;
            overflow:hidden;
            transition: transform .12s ease, filter .12s ease, border-color .12s ease;
            display:flex;
            align-items:center;
            justify-content:center;
        }
        .gem:hover{
            transform: translateY(-2px);
            filter: brightness(1.06);
            border-color: var(--stroke2);
        }
        .gem:active, .gem.pressed{
            transform: translateY(0px) scale(.985);
            filter: brightness(1.12);
            border-color: rgba(255,255,255,.22);
        }

        .gem::before{
            content:"";
            position:absolute;
            inset:-35%;
            background:
                    radial-gradient(circle at 30% 25%, rgba(255,255,255,.38), rgba(255,255,255,0) 55%),
                    radial-gradient(circle at 70% 80%, rgba(0,0,0,.35), rgba(0,0,0,0) 55%);
            transform: rotate(22deg);
            opacity:.85;
            pointer-events:none;
        }

        .gem svg{
            width: 68%;
            height: 68%;
            filter: drop-shadow(0 10px 18px rgba(0,0,0,.45));
            transition: transform .12s ease;
        }
        .gem:hover svg{ transform: translateY(-1px) scale(1.02); }
        .gem.pressed svg{ transform: translateY(0px) scale(.98); }

        .label{
            position:absolute;
            left:10px;
            bottom:10px;
            font-size: 12px;
            font-weight: 900;
            letter-spacing:.2px;
            color: rgba(255,255,255,.92);
            text-shadow: 0 2px 12px rgba(0,0,0,.55);
        }

        .gem{ --c: var(--slate); --c2: rgba(156,163,175,.25); }
        .gem[data-color="ruby"]{ --c: var(--ruby); --c2: rgba(255,31,61,.20); }
        .gem[data-color="emerald"]{ --c: var(--emerald); --c2: rgba(32,217,123,.18); }
        .gem[data-color="sapphire"]{ --c: var(--sapphire); --c2: rgba(42,109,255,.18); }
        .gem[data-color="amethyst"]{ --c: var(--amethyst); --c2: rgba(168,85,247,.18); }
        .gem[data-color="amber"]{ --c: var(--amber); --c2: rgba(245,158,11,.18); }
        .gem[data-color="ice"]{ --c: var(--ice); --c2: rgba(110,231,255,.18); }
        .gem[data-color="slate"]{ --c: var(--slate); --c2: rgba(156,163,175,.18); }

        .gem .bgGlow{
            position:absolute;
            inset:0;
            background: radial-gradient(circle at 40% 30%, rgba(255,255,255,.10), var(--c2) 45%, rgba(0,0,0,.25) 100%);
            pointer-events:none;
        }

        .toast{
            position: fixed;
            left: 50%;
            bottom: 18px;
            transform: translateX(-50%);
            background: rgba(0,0,0,.58);
            border: 1px solid rgba(255,255,255,.14);
            color: var(--text);
            padding: 10px 12px;
            border-radius: 999px;
            font-size: 12px;
            opacity: 0;
            pointer-events:none;
            transition: opacity .18s ease, transform .18s ease;
            z-index: 9999;
            backdrop-filter: blur(10px);
            box-shadow: 0 12px 30px rgba(0,0,0,.45);
        }
        .toast.show{
            opacity: 1;
            transform: translateX(-50%) translateY(-4px);
        }
    </style>
</head>

<body>
<div class="pointer" id="pointer"></div>
<div class="toast" id="toast"></div>

<div class="app">
    <div class="card">
        <div class="cardInner">
            <div class="top">
                <div class="brand">
                    <h1>Gesture Gems</h1>
                    <div class="sub">
                        Start the camera → move pointer with your index finger → pinch thumb+index to press a gem instantly.
                    </div>
                </div>

                <div class="pill">
                    <span class="led" id="camLed"></span>
                    <span id="camText">CAM OFF</span>
                </div>
            </div>

            <div class="controls">
                <button class="primary" id="startBtn">Start Camera</button>
                <button id="stopBtn" disabled>Stop</button>
                <button id="shuffleBtn">Shuffle</button>
                <button id="resetBtn">Reset Colors</button>
            </div>

            <div class="stats">
                <div class="kpi">
                    <span class="led" id="handLed"></span>
                    <span id="handText">NO HAND</span>
                </div>
                <div class="kpi mono" id="pinchText">PINCH: —</div>
                <div class="kpi mono" id="fpsText">FPS: —</div>
            </div>

            <div class="videoWrap">
                <video id="video" playsinline></video>
                <canvas id="canvas"></canvas>
            </div>
        </div>
    </div>

    <div class="card">
        <div class="cardInner">
            <div class="gridHead">
                <h2>Tap Gems</h2>
                <div class="sub" style="text-align:right">
                    Uses the hand farthest-right in the camera image (matches your right-hand usage in mirrored view).
                </div>
            </div>

            <div class="gems" id="gems"></div>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/@mediapipe/hands/hands.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils/camera_utils.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@mediapipe/drawing_utils/drawing_utils.min.js"></script>

<script src="./mediapipe.js"></script>
</body>
</html>
